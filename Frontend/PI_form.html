<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Scientist Project Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6f9;
      margin: 0;
      padding: 0;
    }
    #progress-container {
      max-width: 800px;
      margin: 30px auto 10px;
      padding: 0 20px;
    }
    #progress-bar {
      height: 8px;
      background-color: #e0e0e0;
      border-radius: 4px;
      position: relative;
      overflow: hidden;
    }
    #progress-bar::before {
      content: '';
      height: 100%;
      width: 0%;
      background-color: #28a745;
      display: block;
      transition: width 0.3s ease;
      border-radius: 4px;
    }
    #progress-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    .step {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background-color: #e0e0e0;
      color: #555;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
    }
    .step.active {
      background-color: #28a745;
      color: white;
    }
    form {
      max-width: 800px;
      margin: auto;
      background: #ffffff;
      padding: 35px 40px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.08);
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .form-section {
      display: none;
    }
    .form-section.active {
      display: block;
    }
    h3 {
      margin-bottom: 20px;
      font-size: 20px;
      font-weight: 600;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 8px;
      color: #333;
    }
    label {
      display: block;
      margin: 16px 0 6px;
      font-weight: 500;
      font-size: 15px;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    input[type="email"],
    textarea,
    select {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    .milestone {
      display: flex;
      gap: 12px;
      margin-top: 10px;
    }
    .milestone input {
      flex: 1;
    }
    button[type="button"],
    button[type="submit"] {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .btn-prev { background-color: #6c757d; color: white; margin-right: 10px; }
    .btn-next { background-color: #28a745; color: white; }
    button[type="submit"] {
      background-color: #007bff;
      color: white;
      font-weight: 600;
    }
    #durationText {
      margin-top: 8px;
      display: inline-block;
      font-weight: 600;
      color: #333;
    }
    .review-section {
      margin-bottom: 20px;
      cursor: pointer;
    }
    .review-section:hover {
      background: #f1f1f1;
    }
    .review-section h4 {
      margin-bottom: 6px;
      color: #555;
    }
    .review-section p {
      margin: 4px 0;
    }
  </style>
</head>
<body>

  <div id="navbar-container"></div>

<div id="progress-container">
  <div id="progress-bar"></div>
  <div id="progress-steps">
    <span class="step active">1</span>
    <span class="step">2</span>
    <span class="step">3</span>
    <span class="step">4</span>
  </div>
</div>

<form id="projectForm">
  <!-- Section 1 -->
  <div class="form-section active">
    <h3>Scientist Information</h3>
    <label>Scientist Name</label>
    <input type="text" name="scientistName" value="Rajmouli" readonly />

    <label>Field of Study</label>
    <input type="text" name="fieldOfStudy" required />

    <button type="button" class="btn-next" onclick="nextSection()">Next</button>
  </div>

  <!-- Section 2 -->
  <div class="form-section">
    <h3>Academic Details</h3>
    <label>Academic Institute Name</label>
    <input type="text" name="instituteName" required />

    <label>Institute Address</label>
    <textarea name="instituteAddress" required></textarea>

    <label>Principal Investigator (PI) Name</label>
    <input type="text" name="piName" required />

    <label>PI Email</label>
    <input type="email" name="piEmail" required />

    <label>PI Contact Number</label>
    <input type="text" name="piContact" required />

    <button type="button" class="btn-prev" onclick="prevSection()">Previous</button>
    <button type="button" class="btn-next" onclick="nextSection()">Next</button>
  </div>

  <!-- Section 3 -->
  <div class="form-section">
    <h3>Project Details</h3>
    <label>Project Title</label>
    <input type="text" name="projectTitle" value="Neutrino Signal Mapping" readonly />

    <label>Cost Estimation (INR)</label>
    <input type="number" name="costEstimation" required />

    <label>Start Date</label>
    <input type="date" name="startDate" id="startDate" required />

    <label>End Date</label>
    <input type="date" name="endDate" id="endDate" required />

    <label>Estimated Duration:</label>
    <div id="durationText">—</div>

    <label>Scope</label>
    <textarea name="scope" required></textarea>

    <label>Deliverables</label>
    <textarea name="deliverables" required></textarea>

    <label>Milestones</label>
    <div id="milestonesContainer"></div>
    <button type="button" onclick="addMilestone()">+ Add Milestone</button>

    <button type="button" class="btn-prev" onclick="prevSection()">Previous</button>
    <button type="button" class="btn-next" onclick="generateReview()">Next</button>
  </div>

  <!-- Section 4 (Review) -->
  <div class="form-section" id="reviewSection">
    <h3>Review & Confirm</h3>
    <div id="reviewContent"></div>
    <button type="button" class="btn-prev" onclick="prevSection()">Previous</button>
    <button type="submit">Submit</button>
  </div>
</form>

<div id="footer-container"></div>

<script>
  let currentSection = 0;
  const sections = document.querySelectorAll('.form-section');
  const steps = document.querySelectorAll('.step');

  function updateProgressBar() {
    const percentage = (currentSection / (sections.length - 1)) * 100;
    document.querySelector('#progress-bar::before')?.style?.setProperty('width', `${percentage}%`);
    steps.forEach((step, index) => {
      step.classList.toggle('active', index <= currentSection);
    });
  }

  function showSection(index) {
    sections.forEach((section, i) => {
      section.classList.toggle('active', i === index);
    });
    updateProgressBar();
  }

  function nextSection() {
    if (currentSection < sections.length - 1) {
      currentSection++;
      showSection(currentSection);
    }
  }

  function prevSection() {
    if (currentSection > 0) {
      currentSection--;
      showSection(currentSection);
    }
  }

  function addMilestone() {
    const container = document.getElementById('milestonesContainer');
    const div = document.createElement('div');
    div.className = 'milestone';
    div.innerHTML = `
      <input type="text" placeholder="Milestone description" required />
      <input type="date" required />
    `;
    container.appendChild(div);
  }

  const start = document.getElementById('startDate');
  const end = document.getElementById('endDate');
  const durationText = document.getElementById('durationText');

  function calculateDuration() {
    if (start.value && end.value) {
      const startDate = new Date(start.value);
      const endDate = new Date(end.value);
      const diff = endDate - startDate;
      if (diff >= 0) {
        const months = (diff / (1000 * 60 * 60 * 24 * 30.44)).toFixed(1);
        durationText.textContent = `${months} month(s)`;
      } else {
        durationText.textContent = "Invalid date range";
      }
    }
  }

  start.addEventListener('change', calculateDuration);
  end.addEventListener('change', calculateDuration);

  function generateReview() {
    const form = document.getElementById('projectForm');
    const data = new FormData(form);
    const reviewDiv = document.getElementById('reviewContent');
    reviewDiv.innerHTML = '';

    const fields = {
      0: ["scientistName", "fieldOfStudy"],
      1: ["instituteName", "instituteAddress", "piName", "piEmail", "piContact"],
      2: ["projectTitle", "costEstimation", "startDate", "endDate", "scope", "deliverables"]
    };

    Object.entries(fields).forEach(([sectionIndex, fieldNames]) => {
      const div = document.createElement('div');
      div.className = 'review-section';
      div.onclick = () => {
        currentSection = parseInt(sectionIndex);
        showSection(currentSection);
      };
      div.innerHTML = `<h4>Section ${parseInt(sectionIndex) + 1}</h4>`;
      fieldNames.forEach(name => {
        const value = data.get(name) || "—";
        div.innerHTML += `<p><strong>${name.replace(/([A-Z])/g, ' $1')}:</strong> ${value}</p>`;
      });

      // Add Milestones if section 2
      if (parseInt(sectionIndex) === 2) {
        const milestones = document.querySelectorAll('#milestonesContainer .milestone');
        if (milestones.length > 0) {
          div.innerHTML += `<p><strong>Milestones:</strong></p>`;
          milestones.forEach((milestone, index) => {
            const inputs = milestone.querySelectorAll('input');
            if (inputs.length === 2) {
              div.innerHTML += `<p>- ${inputs[0].value || '—'} (${inputs[1].value || '—'})</p>`;
            }
          });
        }
      }

      reviewDiv.appendChild(div);
    });

    nextSection();
  }

  document.addEventListener('DOMContentLoaded', () => {
    showSection(currentSection);
  });

   // Function to load content from HTML files (navbar.html, footer.html)
    function loadContent() {
      // Fetch the navbar.html and footer.html files
      fetch('components/navbar.html')
        .then(response => response.text())
        .then(data => {
          // Insert navbar HTML content into the placeholder
          document.getElementById('navbar-container').innerHTML = data;
        })
        .catch(error => console.error('Error loading navbar:', error));

      fetch('components/footer.html')
        .then(response => response.text())
        .then(data => {
          // Insert footer HTML content into the placeholder
          document.getElementById('footer-container').innerHTML = data;
        })
        .catch(error => console.error('Error loading footer:', error));
    }

    // Call loadContent when the page is fully loaded
    document.addEventListener('DOMContentLoaded', loadContent);

</script>

</body>
</html>
